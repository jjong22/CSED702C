from pwn import *
import time
import re

context.arch = "i386" # or "amd64"
context.os = "linux"

TARGET= "./target"

num_set = []
p = process([TARGET], env={})

for i in range(7):
    p.recvline()

    payload = b''
    for b_num in num_set:
        payload += b_num + b' '
    for j in range(6 - i):
        payload += b'1 '
    print(payload)
    p.sendline(payload)
    
    for j in range(i):
        p.recvline()
    tmp = p.recvline()
    
    if (i == 6):
        print(tmp)
        p.interactive()
        exit()
    
    num = re.findall(r'[0-9]+', str(tmp))[-1]
    num_set.append(num.encode())
    p.recvline()
    
p.close()